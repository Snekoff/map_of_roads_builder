<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        #stage {
            width: 2000px;
            height: 1000px;
            position: relative;
            border: 2px solid black;
        }

        canvas { position: absolute; }
        #game-layer { z-index: 3; }
        #vertices-layer { z-index: 2; }
        #background-layer { z-index: 1; }
    </style>
</head>
<body>

<div id="stage">
    <!--game-layer contains roads between vertices and text for now-->
    <!--TODO: rebase vertices text to vertices layer if debugging is finished-->
    <canvas id="background-layer" width="2000" height="1000" style="border:1px solid #000000;"></canvas>
    <canvas id="vertices-layer" width="2000" height="1000" style="border:1px solid #000000;"></canvas>
    <canvas id="game-layer" width="2000" height="1000" style="border:1px solid #000000;"></canvas>
</div>

<br>
<input type="button" style="height:50px;width:100px" value="start NEW"  id="start">
<input type="text" style="height:44px;width:100px" value="0"  id="vertices1">
<input type="text" style="height:44px;width:100px" value="0"  id="edges1">
<input type="button" style="height:50px;width:100px" value="next step"  id="next_step">
<input type="button" style="height:50px;width:100px" value="save"  id="save">
<!--input type="button" style="height:50px;width:100px" value="load"  id="load"-->


<form id="upload">
    <label for="file">File to upload</label>
    <input type="file" id="file" accept=".json">

    <button>Upload</button>
</form>



<script type="module">
    import {Graph} from "./graph.js";
    import * as drawingLogic from "./drawing_logic.js";
    import * as saveAndLoad from "./save_and_load_logic.js";

    let graph;
    document.getElementById("start").addEventListener('click', () => {
        graph = drawingLogic.initialVerticesEdgesShow();
    })

    document.getElementById("next_step").addEventListener('click', () => {
        graph = drawingLogic.buildEdgesAndUpdateView(graph);
    })

    document.getElementById("save").addEventListener('click', () => {
        saveAndLoad.save(graph);
    })

    // document.getElementById("load").addEventListener('click', () => {
    //     //graph = saveAndLoad.load();
    //     graph = saveAndLoad.getLoadedGraph();
    //     console.log("graph", graph);
    //     drawingLogic.drawBackgroundImage(0, 0);
    //     drawingLogic.drawVerticesGraphics(graph);
    //     drawingLogic.drawEdgesAndVerticesTextOnCanvas(graph);
    //     //graph = drawingLogic.initialVerticesEdgesShow();
    //     //graph = drawingLogic.buildEdgesAndUpdateView(graph);
    // })




    let form = document.querySelector('#upload');
    form.addEventListener('submit', saveAndLoad.load);
    //console.log("--temp--", temp);

    form.addEventListener('submit', () => {
        setTimeout(() => {
            graph = saveAndLoad.getLoadedGraph();
            console.log("graph", graph);
            drawingLogic.drawBackgroundImage(0, 0);
            drawingLogic.drawVerticesGraphics(graph);
            drawingLogic.drawEdgesAndVerticesTextOnCanvas(graph);
        }, 100)
    })





</script>


</body>
</html>