<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        #stage {
            width: 2000px;
            height: 1000px;
            position: relative;
            border: 2px solid black;
        }

        canvas {
            position: absolute;
        }

        #game-layer {
            z-index: 3;
        }

        #vertices-layer {
            z-index: 2;
        }

        #background-layer {
            z-index: 1;
        }

        input {
            height: 50px;
            width: 100px;
        }

        input[type="file"] {
            height: 50px;
            width: 250px;
        }

        input[type="text"] {
            height: 44px;
            width: 100px;
        }

        button {
            height: 50px;
            width: 100px;
        }

        div {
            margin-top: 5px
        }

        form {
            margin-top: 5px
        }
    </style>
</head>
<body>

<br>
<div id="stage">
    <!--game-layer contains roads between vertices and text for now-->
    <!--TODO: rebase vertices text to vertices layer if debugging is finished-->
    <canvas id="background-layer" width="2000" height="1000" style="border:1px solid #000000;"></canvas>
    <canvas id="vertices-layer" width="2000" height="1000" style="border:1px solid #000000;"></canvas>
    <canvas id="game-layer" width="2000" height="1000" style="border:1px solid #000000;"></canvas>
</div>

<div id="buttons">
    <input type="button" value="start NEW" id="start">
    <input type="text" value="0" id="vertices1">
    <input type="text" value="0" id="edges1">
    <input type="button" value="next step" id="next_step">
    <input type="button" value="save" id="save">
    <!--input type="button" value="load"  id="load"-->
</div>


<form id="upload">
    <label for="file" style="margin-left: 2px; margin-right: 83px">File to upload</label>
    <input type="file" id="file" accept=".json">

    <button>load</button>
</form>


<script type="module">
    import {Graph} from "./graph.js";
    import * as drawingLogic from "./drawing_logic.js";
    import * as saveAndLoad from "./save_and_load_logic.js";

    let graph;
    document.getElementById("start").addEventListener('click', () => {
        graph = drawingLogic.initialVerticesEdgesShow();
    })

    document.getElementById("next_step").addEventListener('click', () => {
        graph = drawingLogic.buildEdgesAndUpdateView(graph);
    })

    document.getElementById("save").addEventListener('click', () => {
        saveAndLoad.save(graph);
    })

    // document.getElementById("load").addEventListener('click', () => {
    //     //graph = saveAndLoad.load();
    //     graph = saveAndLoad.getLoadedGraph();
    //     console.log("graph", graph);
    //     drawingLogic.drawBackgroundImage(0, 0);
    //     drawingLogic.drawVerticesGraphics(graph);
    //     drawingLogic.drawEdgesAndVerticesTextOnCanvas(graph);
    //     //graph = drawingLogic.initialVerticesEdgesShow();
    //     //graph = drawingLogic.buildEdgesAndUpdateView(graph);
    // })


    let form = document.querySelector('#upload');
    form.addEventListener('submit', saveAndLoad.load);
    //console.log("--temp--", temp);

    form.addEventListener('submit', () => {
        setTimeout(() => {
            graph = saveAndLoad.getLoadedGraph();
            console.log("graph", graph);
            drawingLogic.drawBackgroundImage(0, 0);
            drawingLogic.drawVerticesGraphics(graph);
            drawingLogic.drawEdgesAndVerticesTextOnCanvas(graph);
        }, 100)
    })


</script>


</body>
</html>